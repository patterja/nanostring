<tool id='process_nanostring' name='Process and Normalize RCC Files' version='0.0.1'>
    <description>Process and normalize RCC output from nanostring.</description>
    
    <command detect_errors="exit_code"><![CDATA[
        python $__tool_directory__/process_nanostring.py 
          "${rcc}" 
          --samplesheet "${samplesheet}"
          --abfile "${ab_reference}"
    ]]></command>
    
    <inputs>
    <param type="data" name="samplesheet" label="Samplesheet" help="samplesheet.txt"/>
        <param type="data" name="rcc" label="RCC Files" multiple="true" help="rcc file lane 1"/>
        <param type="data" name="ab_reference" label="antibody_reference.csv" optional="true" help="antibody_reference file changes antibody names from the existing ones in RCC files"/>
    </inputs>
    <outputs>
        <data format="tsv" name="rawdata" label="Raw Data $on_string" from_work_dir="rawdata.txt"/>
        <data format="tsv" name="corrected" label="Corrected Output $on_string" from_work_dir="corrected.tsv"/>
        <data format="tsv" name="run_metrics" label="Run metrics" from_work_dir="run_metrics.tsv"/>
    </outputs>
    <help><![CDATA[
This tool takes multiple RCC files, the output from Nanostring. There is an RCC file per sample in a batch of Nanostring data. 

**Input: 
 - RCC files 
 - Nanostring Samplesheet
 - antibody reference file

**Output:
 - rawdata.txt: tab-delimited file with the raw data from nanostring
 - run_metrics.txt: tab-delimited file with run and lane quality metrics
 - corrected.txt: rawdata numbers corrected for:
    1. ERCC control, loading contro
    2. Sample level mean for all antibodies per sample
    3. Immunoglobulin ratio

    ]]></help>

</tool>
